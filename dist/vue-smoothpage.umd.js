(function(e,n){typeof exports=="object"&&typeof module<"u"?module.exports=n(require("vue"),require("pinia")):typeof define=="function"&&define.amd?define(["vue","pinia"],n):(e=typeof globalThis<"u"?globalThis:e||self,e["vue-smoothpage"]=n(e.Vue,e.pinia))})(this,function(e,n){var a,h,E,T,S,x,w,I,Y,k;"use strict";var H=Object.defineProperty;var U=(e,n,i)=>n in e?H(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i;var c=(e,n,i)=>(U(e,typeof n!="symbol"?n+"":n,i),i),P=(e,n,i)=>{if(!n.has(e))throw TypeError("Cannot "+i)};var l=(e,n,i)=>(P(e,n,"read from private field"),i?i.call(e):n.get(e)),m=(e,n,i)=>{if(n.has(e))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(e):n.set(e,i)},_=(e,n,i,g)=>(P(e,n,"write to private field"),g?g.call(e,i):n.set(e,i),i);var f=(e,n,i)=>(P(e,n,"access private method"),i);class i{constructor(t,s,o){c(this,"element");c(this,"cb");c(this,"settings");c(this,"listener",function(t){typeof this.cb=="function"&&t.deltaY&&this.cb({dir:t.deltaY/Math.abs(t.deltaY),wheel:t.deltaY*this.settings.wheelIntensity}),document.dispatchEvent(new CustomEvent("scroll",{bubbles:!0,detail:{direction:t.deltaY/Math.abs(t.deltaY)}}))}.bind(this));this.element=t,this.cb=s,this.settings=o,this.subscribe()}subscribe(){this.element.addEventListener("wheel",this.listener)}unsubscribe(){this.element.removeEventListener("wheel",this.listener)}}class g{constructor(t,s,o){m(this,E);m(this,S);m(this,w);m(this,Y);m(this,a,{sY:0,eY:0});c(this,"prevY",0);m(this,h,void 0);c(this,"cb");c(this,"deltaY");c(this,"minDelta",30);c(this,"settings");this.cb=s,_(this,h,t),f(this,E,T).call(this),this.settings=o,this.useCallback=this.useCallback.bind(this),this.destroy=this.destroy.bind(this)}destroy(){l(this,h).removeEventListener("touchstart",f(this,S,x),!1),l(this,h).removeEventListener("touchmove",f(this,w,I),!1),l(this,h).removeEventListener("touchend",f(this,Y,k),!1)}useCallback(t){typeof this.cb=="function"&&t&&this.cb({dir:t/Math.abs(t),wheel:t})}lerp(t,s,o=.075){return t+(s-t)*o}}a=new WeakMap,h=new WeakMap,E=new WeakSet,T=function(){l(this,h).addEventListener("touchstart",f(this,S,x).bind(this),!1),l(this,h).addEventListener("touchmove",f(this,w,I).bind(this),!1),l(this,h).addEventListener("touchend",f(this,Y,k).bind(this),!1)},S=new WeakSet,x=function(t){const s=t.touches[0];l(this,a).sY=s.screenY,this.prevY=l(this,a).sY,l(this,a).eY=l(this,a).sY},w=new WeakSet,I=function(t){const s=t.touches[0];this.prevY=l(this,a).eY,l(this,a).eY=s.screenY,this.deltaY=l(this,a).sY-l(this,a).eY;const o=l(this,a).sY-this.prevY;Math.abs(o)>Math.abs(this.deltaY)&&(l(this,a).sY=this.prevY),Math.abs(this.deltaY)>this.minDelta&&this.useCallback(this.deltaY)},Y=new WeakSet,k=function(t){Math.abs(this.deltaY)>this.minDelta&&this.useCallback(this.deltaY)};class W{constructor(t,s,o){c(this,"swipe");c(this,"scroll");c(this,"keyboard");c(this,"callback");if(!t){console.error("[Detector]: dom element is required");return}const d={wheelIntensity:o.wheelIntensity||1};this.callback=s||(()=>{}),this.scroll=new i(t,this.controlScroll.bind(this),d),this.swipe=new g(t,this.controlScroll.bind(this),d),this.destroy=this.destroy.bind(this)}controlScroll(t){this.callback(t)}destroy(){this.scroll.unsubscribe(),this.swipe.destroy()}}const q=(r,t=0)=>{const s=e.ref(!0),o=e.ref(performance.now());e.onMounted(()=>d(0)),e.onUnmounted(()=>s.value=!1);function d(b){s.value&&(b-o.value>t&&(r(),o.value=performance.now()),requestAnimationFrame(d))}},N=(r,t,s=.2)=>r+(t-r)*s,B=n.defineStore("smoothScroll",()=>{const r=e.ref(0),t=e.ref(0),s=e.ref(!1),o=e.ref(!1);return{currentScrollPosition:r,isEnabled:o,nextScrollPosition:t,isTriggeringScrollPosition:s,setCurrentScrollPosition:u=>{r.value=u},setIsEnabled:u=>{o.value=u},setNextScrollPosition:u=>{t.value=u},setIsTriggeringScrollPosition:u=>{s.value=u}}}),R={class:"t-smoothpage"},$=e.defineComponent({__name:"index",props:{smooth:{default:.2},wheelIntensity:{default:2},minWidth:{default:0},preventScroll:{type:Boolean,default:!1},renderDelay:{default:0}},setup(r){const t=r,s=B(),o=e.ref(!1),d=e.ref(null),b=e.ref(null),v=e.ref(!1);e.onMounted(()=>{s.setIsEnabled(window.innerWidth>=t.minWidth),o.value=!0}),e.onUnmounted(()=>{o.value=!1}),e.watchEffect(()=>{var p,y,M,D,L;if(s.isEnabled&&!v.value){(y=(p=document.querySelector("html"))==null?void 0:p.classList)==null||y.add("t-smoothscroll--enabled"),d.value=new W(document,C,{wheelIntensity:t.wheelIntensity}),v.value=!0;return}!s.isEnabled&&v.value&&((D=(M=document.querySelector("html"))==null?void 0:M.classList)==null||D.remove("t-smoothscroll--enabled"),(L=d.value)==null||L.destroy(),v.value=!1)});function C(p){if(t.preventScroll||!b.value)return;const y=b.value.getBoundingClientRect().height-window.innerHeight;s.setNextScrollPosition(Math.max(0,Math.min(s.currentScrollPosition+p.wheel,y)))}q(()=>{t.preventScroll||o.value&&(s.isTriggeringScrollPosition||(s.setIsEnabled(window.innerWidth>=t.minWidth),s.isEnabled?s.setCurrentScrollPosition(N(s.currentScrollPosition,s.nextScrollPosition,t.smooth)):(s.setCurrentScrollPosition(window.scrollY),s.setNextScrollPosition(window.scrollY))))},t.renderDelay);const u=e.computed(()=>s.isEnabled?{transform:`translate3d(0, ${-s.currentScrollPosition}px, 0)`}:{});return(p,y)=>(e.openBlock(),e.createElementBlock("div",R,[e.createElementVNode("div",{ref_key:"contentRef",ref:b,style:e.normalizeStyle(e.unref(u)),class:"t-smoothpage--body"},[e.renderSlot(p.$slots,"default")],4)]))}}),V="";return{install(r,t){r.component("SmoothPage",$)}}});
