"use strict";var V=Object.defineProperty;var J=(e,t,o)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var d=(e,t,o)=>(J(e,typeof t!="symbol"?t+"":t,o),o),Y=(e,t,o)=>{if(!t.has(e))throw TypeError("Cannot "+o)};var c=(e,t,o)=>(Y(e,t,"read from private field"),o?o.call(e):t.get(e)),C=(e,t,o)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,o)},H=(e,t,o,a)=>(Y(e,t,"write to private field"),a?a.call(e,o):t.set(e,o),o);var P=(e,t,o)=>(Y(e,t,"access private method"),o);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const n=require("vue"),z=require("pinia");class Q{constructor(t,o,a){d(this,"element");d(this,"cb");d(this,"settings");d(this,"listener",function(t){typeof this.cb=="function"&&t.deltaY&&this.cb({dir:t.deltaY/Math.abs(t.deltaY),wheel:t.deltaY*this.settings.wheelIntensity})}.bind(this));this.element=t,this.cb=o,this.settings=a,this.subscribe()}subscribe(){this.element.addEventListener("wheel",this.listener)}unsubscribe(){this.element.removeEventListener("wheel",this.listener)}}var f,S,R,U,M,A,p,L,_,B;class g{constructor(t,o,a){C(this,R);C(this,M);C(this,p);C(this,_);C(this,f,{sY:0,eY:0});d(this,"prevY",0);C(this,S,void 0);d(this,"cb");d(this,"deltaY");d(this,"minDelta");d(this,"settings");this.cb=o,H(this,S,t),P(this,R,U).call(this),this.settings=a,this.minDelta=a.minTouchmoveDistance,this.useCallback=this.useCallback.bind(this),this.destroy=this.destroy.bind(this)}destroy(){c(this,S).removeEventListener("touchstart",P(this,M,A),!1),c(this,S).removeEventListener("touchmove",P(this,p,L),!1),c(this,S).removeEventListener("touchend",P(this,_,B),!1)}useCallback(t){typeof this.cb=="function"&&t&&this.cb({dir:t/Math.abs(t),wheel:t*this.settings.touchmoveIntensity})}}f=new WeakMap,S=new WeakMap,R=new WeakSet,U=function(){c(this,S).addEventListener("touchstart",P(this,M,A).bind(this),!1),c(this,S).addEventListener("touchmove",P(this,p,L).bind(this),!1),c(this,S).addEventListener("touchend",P(this,_,B).bind(this),!1)},M=new WeakSet,A=function(t){const o=t.touches[0];c(this,f).sY=o.screenY,this.prevY=c(this,f).sY,c(this,f).eY=c(this,f).sY},p=new WeakSet,L=function(t){const o=t.touches[0];this.prevY=c(this,f).eY,c(this,f).eY=o.screenY,this.deltaY=c(this,f).sY-c(this,f).eY;const a=c(this,f).sY-this.prevY;Math.abs(a)>Math.abs(this.deltaY)&&(c(this,f).sY=this.prevY),Math.abs(this.deltaY)>this.minDelta&&this.useCallback(this.deltaY)},_=new WeakSet,B=function(t){Math.abs(this.deltaY)>this.minDelta&&this.useCallback(this.deltaY)};var E=(e=>(e.MS_EDGE="MS_EDGE",e.EDGE_CHROMIUM_BASED="EDGE_CHROMIUM_BASED",e.OPERA="OPERA",e.CHROME="CHROME",e.MS_IE="MS_IE",e.MOZILLA_FIREFOX="MOZILLA_FIREFOX",e.SAFARI="SAFARI",e.OTHER="OTHER",e))(E||{});const ee=()=>{const e=window.navigator.userAgent.toLowerCase();switch(!0){case e.indexOf("edge")>-1:return"MS_EDGE";case e.indexOf("edg/")>-1:return"EDGE_CHROMIUM_BASED";case(e.indexOf("opr")>-1&&!!window.opr):return"OPERA";case(e.indexOf("chrome")>-1&&!!window.chrome):return"CHROME";case e.indexOf("trident")>-1:return"MS_IE";case e.indexOf("firefox")>-1:return"MOZILLA_FIREFOX";case e.indexOf("safari")>-1:return"SAFARI";default:return"OTHER"}};class oe{constructor(t,o,a,h){d(this,"swipe");d(this,"scroll");d(this,"keyboard");d(this,"callback");if(!t){console.error("[Detector]: dom element is required");return}const l={wheelIntensity:a.wheelIntensity,touchmoveIntensity:a.touchmoveIntensity,minTouchmoveDistance:a.minTouchmoveDistance,safariWheelIntensity:a.safariWheelIntensity,safariTouchmoveIntensity:a.safariTouchmoveIntensity,chromeWheelIntensity:a.chromeWheelIntensity,chromeTouchmoveIntensity:a.chromeTouchmoveIntensity,operaWheelIntensity:a.operaWheelIntensity,operaTouchmoveIntensity:a.operaTouchmoveIntensity,edgeWheelIntensity:a.edgeWheelIntensity,edgeTouchmoveIntensity:a.edgeTouchmoveIntensity,mozillaWheelIntensity:a.mozillaWheelIntensity,mozillaTouchmoveIntensity:a.mozillaTouchmoveIntensity},u={wheelIntensity:v("WheelIntensity"),touchmoveIntensity:v("TouchmoveIntensity"),minTouchmoveDistance:l.minTouchmoveDistance};function v(m){switch(h){case E.SAFARI:return l[`safari${m}`];case E.CHROME:return l[`chrome${m}`];case E.OPERA:return l[`opera${m}`];case(E.MS_EDGE||E.EDGE_CHROMIUM_BASED):return l[`edge${m}`];case E.MOZILLA_FIREFOX:return l[`mozilla${m}`];default:return m==="WheelIntensity"?l.wheelIntensity:l.touchmoveIntensity}}this.callback=o||(()=>{}),this.scroll=new Q(t,this.controlScroll.bind(this),u),this.swipe=new g(t,this.controlScroll.bind(this),u),this.destroy=this.destroy.bind(this)}controlScroll(t){this.callback(t)}destroy(){this.scroll.unsubscribe(),this.swipe.destroy()}}const te=(e,t=0)=>{const o=n.ref(!0),a=n.ref(performance.now());n.onMounted(()=>h(0)),n.onUnmounted(()=>o.value=!1);function h(l){o.value&&(l-a.value>t&&(e(),a.value=performance.now()),requestAnimationFrame(h))}},ne=(e,t,o)=>t===0&&e<.1?0:e+(t-e)*o;var x=(e=>(e.DESKTOP="DESKTOP",e.TABLET="TABLET",e.MOBILE="MOBILE",e))(x||{});function le(){const e=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)?"TABLET":/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(e)?"MOBILE":"DESKTOP"}const q=z.defineStore("privateSmoothPage",()=>{const e=n.ref(null),t=n.ref(0),o=n.ref(0),a=n.ref(!1),h=n.ref(!1),l=n.ref(!1),u=n.ref(!1),v=n.ref(x.DESKTOP),m=n.ref(E.OTHER),b=n.ref(!1),T=n.ref(!1),D=n.ref(!1),O=n.ref(0),y=r=>{e.value=r},s=r=>{t.value=r},w=r=>{h.value=r},I=r=>{o.value=r},N=r=>{a.value=r},$=r=>{l.value=r},K=r=>{u.value=r},X=r=>{v.value=r},Z=r=>{m.value=r},F=r=>{T.value=r},k=r=>{b.value=r},j=r=>{D.value=r},W=r=>{O.value=r};return{settings:e,currentScrollPosition:t,isEnabled:h,nextScrollPosition:o,isTriggeringScrollPosition:a,isMounted:l,isInited:u,deviceType:v,needReload:T,isDestroyedByUser:b,browser:m,isPreventScroll:D,savedCurrentScrollPositionForDestroy:O,setSettings:y,setCurrentScrollPosition:s,setIsEnabled:w,setNextScrollPosition:I,setIsTriggeringScrollPosition:N,setIsMounted:$,setIsInited:K,setDeviceType:X,setNeedReload:F,setBrowser:Z,preventScroll:j,setSavedCurrentScrollPositionForDestroy:W,reload:(r=!1)=>{F(!0),r&&(s(0),I(0),W(0))},destroy:(r=!1)=>{k(!0),r&&(s(0),I(0),W(0))},init:(r=!1)=>{k(!1),r&&(s(0),I(0),W(0))}}}),ae=e=>{var t,o,a,h,l,u;return{smoothness:(e==null?void 0:e.smoothness)||i.smoothness,wheelIntensity:(e==null?void 0:e.wheelIntensity)||i.wheelIntensity,touchmoveIntensity:(e==null?void 0:e.touchmoveIntensity)||i.touchmoveIntensity,safariWheelIntensity:(e==null?void 0:e.safariWheelIntensity)||(e==null?void 0:e.wheelIntensity)||i.wheelIntensity,safariTouchmoveIntensity:(e==null?void 0:e.safariTouchmoveIntensity)||(e==null?void 0:e.touchmoveIntensity)||i.wheelIntensity,chromeWheelIntensity:(e==null?void 0:e.chromeWheelIntensity)||(e==null?void 0:e.wheelIntensity)||i.wheelIntensity,chromeTouchmoveIntensity:(e==null?void 0:e.chromeTouchmoveIntensity)||(e==null?void 0:e.touchmoveIntensity)||i.wheelIntensity,operaWheelIntensity:(e==null?void 0:e.operaWheelIntensity)||(e==null?void 0:e.wheelIntensity)||i.wheelIntensity,operaTouchmoveIntensity:(e==null?void 0:e.operaTouchmoveIntensity)||(e==null?void 0:e.touchmoveIntensity)||i.wheelIntensity,edgeWheelIntensity:(e==null?void 0:e.edgeWheelIntensity)||(e==null?void 0:e.wheelIntensity)||i.wheelIntensity,edgeTouchmoveIntensity:(e==null?void 0:e.edgeTouchmoveIntensity)||(e==null?void 0:e.touchmoveIntensity)||i.wheelIntensity,mozillaWheelIntensity:(e==null?void 0:e.mozillaWheelIntensity)||(e==null?void 0:e.wheelIntensity)||i.wheelIntensity,mozillaTouchmoveIntensity:(e==null?void 0:e.mozillaTouchmoveIntensity)||(e==null?void 0:e.touchmoveIntensity)||i.wheelIntensity,minTouchmoveDistance:(e==null?void 0:e.minTouchmoveDistance)||i.minTouchmoveDistance,minWidth:(e==null?void 0:e.minWidth)||i.minWidth,renderDelay:(e==null?void 0:e.renderDelay)||i.renderDelay,enableOnTouchDevices:(e==null?void 0:e.enableOnTouchDevices)||i.enableOnTouchDevices,resetScrollPositionOnStateChanging:(e==null?void 0:e.resetScrollPositionOnStateChanging)||i.resetScrollPositionOnStateChanging,defaultClassNames:{smoothPage:((t=e==null?void 0:e.defaultClassNames)==null?void 0:t.smoothPage)||i.defaultClassNames.smoothPage,smoothPageBody:((o=e==null?void 0:e.defaultClassNames)==null?void 0:o.smoothPageBody)||i.defaultClassNames.smoothPageBody,smoothPageEnabled:((a=e==null?void 0:e.defaultClassNames)==null?void 0:a.smoothPageEnabled)||i.defaultClassNames.smoothPageEnabled},additionalClassNames:{smoothPage:((h=e==null?void 0:e.additionalClassNames)==null?void 0:h.smoothPage)||i.additionalClassNames.smoothPage,smoothPageBody:((l=e==null?void 0:e.additionalClassNames)==null?void 0:l.smoothPageBody)||i.additionalClassNames.smoothPageBody,smoothPageEnabled:((u=e==null?void 0:e.additionalClassNames)==null?void 0:u.smoothPageEnabled)||i.additionalClassNames.smoothPageEnabled}}},i={smoothness:.075,wheelIntensity:4,touchmoveIntensity:4,minTouchmoveDistance:40,minWidth:0,renderDelay:0,enableOnTouchDevices:!0,resetScrollPositionOnStateChanging:!1,defaultClassNames:{smoothPage:"t-smoothpage",smoothPageBody:"t-smoothpage--body",smoothPageEnabled:"t-smoothpage--enabled"},additionalClassNames:{smoothPage:"",smoothPageBody:"",smoothPageEnabled:""}},G=n.defineComponent({__name:"index",props:{settings:null},setup(e){const t=e,o=q(),a=n.inject("smoothPageSettings"),h=ae(a),l=n.reactive({...h,...(t==null?void 0:t.settings)||{}});n.watchEffect(()=>{o.setSettings(l)});const u=n.ref(null),v=n.ref(null);n.onMounted(()=>{o.setSettings(l),o.setDeviceType(le()),o.setIsEnabled(D()),o.setBrowser(ee()),o.setIsMounted(!0)}),n.onUnmounted(()=>{o.setIsMounted(!1)}),n.watchEffect(()=>{if(o.isEnabled&&!o.isInited){m();return}!o.isEnabled&&o.isInited&&b()});function m(){var y,s,w,I;l.defaultClassNames.smoothPageEnabled&&((s=(y=document.querySelector("html"))==null?void 0:y.classList)==null||s.add(l.defaultClassNames.smoothPageEnabled)),l.additionalClassNames.smoothPageEnabled&&((I=(w=document.querySelector("html"))==null?void 0:w.classList)==null||I.add(l.additionalClassNames.smoothPageEnabled)),u.value=new oe(document,T,l,o.browser),l.resetScrollPositionOnStateChanging&&(o.setCurrentScrollPosition(0),o.setNextScrollPosition(0),window.scroll(0,0)),o.setIsInited(!0),o.setNeedReload(!1)}function b(){var y,s,w,I,N;l.defaultClassNames.smoothPageEnabled&&((s=(y=document.querySelector("html"))==null?void 0:y.classList)==null||s.remove(l.defaultClassNames.smoothPageEnabled)),l.additionalClassNames.smoothPageEnabled&&((I=(w=document.querySelector("html"))==null?void 0:w.classList)==null||I.remove(l.additionalClassNames.smoothPageEnabled)),(N=u.value)==null||N.destroy(),l.resetScrollPositionOnStateChanging?(o.setCurrentScrollPosition(0),o.setNextScrollPosition(0),window.scroll(0,0)):window.scroll(0,o.savedCurrentScrollPositionForDestroy),o.setIsInited(!1)}n.watchEffect(()=>{o.needReload&&b()});function T(y){if(o.isPreventScroll||!v.value)return;const s=v.value.getBoundingClientRect().height-window.innerHeight;o.setNextScrollPosition(Math.max(0,Math.min(o.currentScrollPosition+y.wheel,s)))}te(()=>{o.isPreventScroll||o.isMounted&&(o.isTriggeringScrollPosition||(o.setIsEnabled(D()),o.isEnabled?(o.setCurrentScrollPosition(ne(o.currentScrollPosition,o.nextScrollPosition,l.smoothness)),o.setSavedCurrentScrollPositionForDestroy(o.currentScrollPosition)):(o.setCurrentScrollPosition(window.scrollY),o.setNextScrollPosition(window.scrollY))))},l.renderDelay);function D(){return o.isDestroyedByUser?!1:(l.enableOnTouchDevices||o.deviceType===x.DESKTOP)&&window.innerWidth>=l.minWidth}const O=n.computed(()=>o.isEnabled?{transform:`translate3d(0, ${-o.currentScrollPosition}px, 0)`}:{});return(y,s)=>(n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass([l.defaultClassNames.smoothPage,l.additionalClassNames.smoothPage])},[n.createElementVNode("div",{ref_key:"contentRef",ref:v,style:n.normalizeStyle(n.unref(O)),class:n.normalizeClass([l.defaultClassNames.smoothPageBody,l.additionalClassNames.smoothPageBody])},[n.renderSlot(y.$slots,"default")],6)],2))}});const re=z.defineStore("publicSmoothPage",()=>{const e=q(),t=n.computed(()=>e.settings),o=n.computed(()=>e.currentScrollPosition),a=n.computed(()=>e.isEnabled),h=n.computed(()=>e.isTriggeringScrollPosition),l=n.computed(()=>e.isMounted),u=n.computed(()=>e.isInited),v=n.computed(()=>e.deviceType),m=n.computed(()=>e.browser),b=n.computed(()=>e.isPreventScroll);return{settings:t,currentScrollPosition:o,isEnabled:a,isTriggeringScrollPosition:h,isMounted:l,isInited:u,deviceType:v,browser:m,isPreventScroll:b,preventScroll:s=>e.preventScroll(s),reload:(s=!1)=>e.reload(s),destroy:(s=!1)=>e.destroy(s),init:(s=!1)=>e.init(s)}}),ie={install(e,t){e.component("SmoothPage",G),e.provide("smoothPageSettings",t||{})}};exports.SmoothPage=G;exports.default=ie;exports.useSmoothPage=re;
