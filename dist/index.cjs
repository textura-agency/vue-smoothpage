"use strict";var Q=Object.defineProperty;var g=(e,t,o)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var d=(e,t,o)=>(g(e,typeof t!="symbol"?t+"":t,o),o),Y=(e,t,o)=>{if(!t.has(e))throw TypeError("Cannot "+o)};var c=(e,t,o)=>(Y(e,t,"read from private field"),o?o.call(e):t.get(e)),O=(e,t,o)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,o)},z=(e,t,o,l)=>(Y(e,t,"write to private field"),l?l.call(e,o):t.set(e,o),o);var P=(e,t,o)=>(Y(e,t,"access private method"),o);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const n=require("vue"),H=require("pinia");class ee{constructor(t,o,l){d(this,"element");d(this,"cb");d(this,"settings");d(this,"listener",function(t){typeof this.cb=="function"&&t.deltaY&&this.cb({dir:t.deltaY/Math.abs(t.deltaY),wheel:t.deltaY*this.settings.wheelIntensity})}.bind(this));this.element=t,this.cb=o,this.settings=l,this.subscribe()}subscribe(){this.element.addEventListener("wheel",this.listener)}unsubscribe(){this.element.removeEventListener("wheel",this.listener)}}var y,S,R,U,p,A,_,L,N,B;class oe{constructor(t,o,l){O(this,R);O(this,p);O(this,_);O(this,N);O(this,y,{sY:0,eY:0});d(this,"prevY",0);O(this,S,void 0);d(this,"cb");d(this,"deltaY");d(this,"minDelta");d(this,"settings");this.cb=o,z(this,S,t),P(this,R,U).call(this),this.settings=l,this.minDelta=l.minTouchmoveDistance,this.useCallback=this.useCallback.bind(this),this.destroy=this.destroy.bind(this)}destroy(){c(this,S).removeEventListener("touchstart",P(this,p,A),!1),c(this,S).removeEventListener("touchmove",P(this,_,L),!1),c(this,S).removeEventListener("touchend",P(this,N,B),!1)}useCallback(t){typeof this.cb=="function"&&t&&this.cb({dir:t/Math.abs(t),wheel:t*this.settings.touchmoveIntensity})}}y=new WeakMap,S=new WeakMap,R=new WeakSet,U=function(){c(this,S).addEventListener("touchstart",P(this,p,A).bind(this),!1),c(this,S).addEventListener("touchmove",P(this,_,L).bind(this),!1),c(this,S).addEventListener("touchend",P(this,N,B).bind(this),!1)},p=new WeakSet,A=function(t){const o=t.touches[0];c(this,y).sY=o.screenY,this.prevY=c(this,y).sY,c(this,y).eY=c(this,y).sY},_=new WeakSet,L=function(t){const o=t.touches[0];this.prevY=c(this,y).eY,c(this,y).eY=o.screenY,this.deltaY=c(this,y).sY-c(this,y).eY;const l=c(this,y).sY-this.prevY;Math.abs(l)>Math.abs(this.deltaY)&&(c(this,y).sY=this.prevY),Math.abs(this.deltaY)>this.minDelta&&this.useCallback(this.deltaY)},N=new WeakSet,B=function(t){Math.abs(this.deltaY)>this.minDelta&&this.useCallback(this.deltaY)};var E=(e=>(e.MS_EDGE="MS_EDGE",e.EDGE_CHROMIUM_BASED="EDGE_CHROMIUM_BASED",e.OPERA="OPERA",e.CHROME="CHROME",e.MS_IE="MS_IE",e.MOZILLA_FIREFOX="MOZILLA_FIREFOX",e.SAFARI="SAFARI",e.OTHER="OTHER",e))(E||{});const te=()=>{const e=window.navigator.userAgent.toLowerCase();switch(!0){case e.indexOf("edge")>-1:return"MS_EDGE";case e.indexOf("edg/")>-1:return"EDGE_CHROMIUM_BASED";case(e.indexOf("opr")>-1&&!!window.opr):return"OPERA";case(e.indexOf("chrome")>-1&&!!window.chrome):return"CHROME";case e.indexOf("trident")>-1:return"MS_IE";case e.indexOf("firefox")>-1:return"MOZILLA_FIREFOX";case e.indexOf("safari")>-1:return"SAFARI";default:return"OTHER"}};class ne{constructor(t,o,l,h){d(this,"swipe");d(this,"scroll");d(this,"keyboard");d(this,"callback");if(!t){console.error("[Detector]: dom element is required");return}const a={wheelIntensity:l.wheelIntensity,touchmoveIntensity:l.touchmoveIntensity,minTouchmoveDistance:l.minTouchmoveDistance,safariWheelIntensity:l.safariWheelIntensity,safariTouchmoveIntensity:l.safariTouchmoveIntensity,chromeWheelIntensity:l.chromeWheelIntensity,chromeTouchmoveIntensity:l.chromeTouchmoveIntensity,operaWheelIntensity:l.operaWheelIntensity,operaTouchmoveIntensity:l.operaTouchmoveIntensity,edgeWheelIntensity:l.edgeWheelIntensity,edgeTouchmoveIntensity:l.edgeTouchmoveIntensity,mozillaWheelIntensity:l.mozillaWheelIntensity,mozillaTouchmoveIntensity:l.mozillaTouchmoveIntensity},u={wheelIntensity:I("WheelIntensity"),touchmoveIntensity:I("TouchmoveIntensity"),minTouchmoveDistance:a.minTouchmoveDistance};function I(m){switch(h){case E.SAFARI:return a[`safari${m}`];case E.CHROME:return a[`chrome${m}`];case E.OPERA:return a[`opera${m}`];case(E.MS_EDGE||E.EDGE_CHROMIUM_BASED):return a[`edge${m}`];case E.MOZILLA_FIREFOX:return a[`mozilla${m}`];default:return m==="WheelIntensity"?a.wheelIntensity:a.touchmoveIntensity}}this.callback=o||(()=>{}),this.scroll=new ee(t,this.controlScroll.bind(this),u),this.swipe=new oe(t,this.controlScroll.bind(this),u),this.destroy=this.destroy.bind(this)}controlScroll(t){this.callback(t)}destroy(){this.scroll.unsubscribe(),this.swipe.destroy()}}const ae=(e,t=0)=>{const o=n.ref(!0),l=n.ref(performance.now());n.onMounted(()=>h(0)),n.onUnmounted(()=>o.value=!1);function h(a){o.value&&(a-l.value>t&&(e(),l.value=performance.now()),requestAnimationFrame(h))}},le=(e,t,o)=>t===0&&e<.1?0:e+(t-e)*o;var x=(e=>(e.DESKTOP="DESKTOP",e.TABLET="TABLET",e.MOBILE="MOBILE",e))(x||{});function re(){const e=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)?"TABLET":/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(e)?"MOBILE":"DESKTOP"}const q=H.defineStore("privateSmoothPage",()=>{const e=n.ref(null),t=n.ref(0),o=n.ref(0),l=n.ref(!1),h=n.ref(!1),a=n.ref(!1),u=n.ref(!1),I=n.ref(!1),m=n.ref(x.DESKTOP),b=n.ref(E.OTHER),D=n.ref(!1),T=n.ref(!1),M=n.ref(!1),f=n.ref(0),s=r=>{e.value=r},v=r=>{t.value=r},w=r=>{h.value=r},C=r=>{o.value=r},$=r=>{l.value=r},K=r=>{a.value=r},X=r=>{I.value=r},Z=r=>{u.value=r},j=r=>{m.value=r},V=r=>{b.value=r},F=r=>{T.value=r},k=r=>{D.value=r},J=r=>{M.value=r},W=r=>{f.value=r};return{settings:e,currentScrollPosition:t,isEnabled:h,nextScrollPosition:o,isTriggeringScrollPosition:l,isMounted:a,isInited:I,isEarlierMounted:u,deviceType:m,needReload:T,isDestroyedByUser:D,browser:b,isPreventScroll:M,savedCurrentScrollPositionForDestroy:f,setSettings:s,setCurrentScrollPosition:v,setIsEnabled:w,setNextScrollPosition:C,setIsTriggeringScrollPosition:$,setIsMounted:K,setIsInited:X,setIsEarlierMounted:Z,setDeviceType:j,setNeedReload:F,setBrowser:V,preventScroll:J,setSavedCurrentScrollPositionForDestroy:W,reload:(r=!1)=>{F(!0),r&&(v(0),C(0),W(0))},destroy:(r=!1)=>{k(!0),r&&(v(0),C(0),W(0))},init:(r=!1)=>{k(!1),r&&(v(0),C(0),W(0))}}}),ie=e=>{var t,o,l,h,a,u;return{smoothness:(e==null?void 0:e.smoothness)||i.smoothness,wheelIntensity:(e==null?void 0:e.wheelIntensity)||i.wheelIntensity,touchmoveIntensity:(e==null?void 0:e.touchmoveIntensity)||i.touchmoveIntensity,safariWheelIntensity:(e==null?void 0:e.safariWheelIntensity)||(e==null?void 0:e.wheelIntensity)||i.wheelIntensity,safariTouchmoveIntensity:(e==null?void 0:e.safariTouchmoveIntensity)||(e==null?void 0:e.touchmoveIntensity)||i.wheelIntensity,chromeWheelIntensity:(e==null?void 0:e.chromeWheelIntensity)||(e==null?void 0:e.wheelIntensity)||i.wheelIntensity,chromeTouchmoveIntensity:(e==null?void 0:e.chromeTouchmoveIntensity)||(e==null?void 0:e.touchmoveIntensity)||i.wheelIntensity,operaWheelIntensity:(e==null?void 0:e.operaWheelIntensity)||(e==null?void 0:e.wheelIntensity)||i.wheelIntensity,operaTouchmoveIntensity:(e==null?void 0:e.operaTouchmoveIntensity)||(e==null?void 0:e.touchmoveIntensity)||i.wheelIntensity,edgeWheelIntensity:(e==null?void 0:e.edgeWheelIntensity)||(e==null?void 0:e.wheelIntensity)||i.wheelIntensity,edgeTouchmoveIntensity:(e==null?void 0:e.edgeTouchmoveIntensity)||(e==null?void 0:e.touchmoveIntensity)||i.wheelIntensity,mozillaWheelIntensity:(e==null?void 0:e.mozillaWheelIntensity)||(e==null?void 0:e.wheelIntensity)||i.wheelIntensity,mozillaTouchmoveIntensity:(e==null?void 0:e.mozillaTouchmoveIntensity)||(e==null?void 0:e.touchmoveIntensity)||i.wheelIntensity,watchIsEnabledOn:(e==null?void 0:e.watchIsEnabledOn)||i.watchIsEnabledOn,minTouchmoveDistance:(e==null?void 0:e.minTouchmoveDistance)||i.minTouchmoveDistance,minWidth:(e==null?void 0:e.minWidth)||i.minWidth,renderDelay:(e==null?void 0:e.renderDelay)||i.renderDelay,enableOnTouchDevices:(e==null?void 0:e.enableOnTouchDevices)||i.enableOnTouchDevices,resetScrollPositionOnStateChanging:(e==null?void 0:e.resetScrollPositionOnStateChanging)||i.resetScrollPositionOnStateChanging,reloadPageOnStateChanging:(e==null?void 0:e.reloadPageOnStateChanging)||i.reloadPageOnStateChanging,defaultClassNames:{smoothPage:((t=e==null?void 0:e.defaultClassNames)==null?void 0:t.smoothPage)||i.defaultClassNames.smoothPage,smoothPageBody:((o=e==null?void 0:e.defaultClassNames)==null?void 0:o.smoothPageBody)||i.defaultClassNames.smoothPageBody,smoothPageEnabled:((l=e==null?void 0:e.defaultClassNames)==null?void 0:l.smoothPageEnabled)||i.defaultClassNames.smoothPageEnabled},additionalClassNames:{smoothPage:((h=e==null?void 0:e.additionalClassNames)==null?void 0:h.smoothPage)||i.additionalClassNames.smoothPage,smoothPageBody:((a=e==null?void 0:e.additionalClassNames)==null?void 0:a.smoothPageBody)||i.additionalClassNames.smoothPageBody,smoothPageEnabled:((u=e==null?void 0:e.additionalClassNames)==null?void 0:u.smoothPageEnabled)||i.additionalClassNames.smoothPageEnabled}}},i={smoothness:.075,wheelIntensity:4,touchmoveIntensity:4,minTouchmoveDistance:40,watchIsEnabledOn:"load-resize",minWidth:0,renderDelay:0,enableOnTouchDevices:!0,resetScrollPositionOnStateChanging:!1,reloadPageOnStateChanging:!1,defaultClassNames:{smoothPage:"t-smoothpage",smoothPageBody:"t-smoothpage--body",smoothPageEnabled:"t-smoothpage--enabled"},additionalClassNames:{smoothPage:"",smoothPageBody:"",smoothPageEnabled:""}},G=n.defineComponent({__name:"index",props:{settings:null},setup(e){const t=e,o=q(),l=n.inject("smoothPageSettings",void 0),h=ie(l),a=n.reactive({...h,...(t==null?void 0:t.settings)||{}});n.watchEffect(()=>{o.setSettings(a)});const u=n.ref(null),I=n.ref(null);n.onMounted(()=>{o.setSettings(a),o.setDeviceType(re()),o.setIsEnabled(T()),o.setBrowser(te()),o.setIsMounted(!0),setTimeout(()=>o.setIsEarlierMounted(!0),100)}),n.onUnmounted(()=>{o.setIsMounted(!1)}),n.watchEffect(()=>{if(o.isEnabled&&!o.isInited){m();return}!o.isEnabled&&o.isInited&&b()});function m(){var f,s,v,w;a.defaultClassNames.smoothPageEnabled&&((s=(f=document.querySelector("html"))==null?void 0:f.classList)==null||s.add(a.defaultClassNames.smoothPageEnabled)),a.additionalClassNames.smoothPageEnabled&&((w=(v=document.querySelector("html"))==null?void 0:v.classList)==null||w.add(a.additionalClassNames.smoothPageEnabled)),u.value=new ne(document,D,a,o.browser),a.resetScrollPositionOnStateChanging&&(o.setCurrentScrollPosition(0),o.setNextScrollPosition(0),window.scroll(0,0)),o.setIsInited(!0),o.setNeedReload(!1),a.reloadPageOnStateChanging&&o.isEarlierMounted&&setTimeout(()=>location.reload(),100)}function b(){var f,s,v,w,C;a.defaultClassNames.smoothPageEnabled&&((s=(f=document.querySelector("html"))==null?void 0:f.classList)==null||s.remove(a.defaultClassNames.smoothPageEnabled)),a.additionalClassNames.smoothPageEnabled&&((w=(v=document.querySelector("html"))==null?void 0:v.classList)==null||w.remove(a.additionalClassNames.smoothPageEnabled)),(C=u.value)==null||C.destroy(),a.resetScrollPositionOnStateChanging?(o.setCurrentScrollPosition(0),o.setNextScrollPosition(0),window.scroll(0,0)):window.scroll(0,o.savedCurrentScrollPositionForDestroy),o.setIsInited(!1),a.reloadPageOnStateChanging&&o.isEarlierMounted&&setTimeout(()=>location.reload(),100)}n.watchEffect(()=>{o.needReload&&b()});function D(f){if(o.isPreventScroll||!I.value)return;const s=I.value.getBoundingClientRect().height-window.innerHeight;o.setNextScrollPosition(Math.max(0,Math.min(o.currentScrollPosition+f.wheel,s)))}ae(()=>{o.isPreventScroll||o.isMounted&&(o.isTriggeringScrollPosition||(a.watchIsEnabledOn==="load-resize"&&o.setIsEnabled(T()),o.isEnabled?(o.setCurrentScrollPosition(le(o.currentScrollPosition,o.nextScrollPosition,a.smoothness)),o.setSavedCurrentScrollPositionForDestroy(o.currentScrollPosition)):(o.setCurrentScrollPosition(window.scrollY),o.setNextScrollPosition(window.scrollY))))},a.renderDelay);function T(){return o.isDestroyedByUser?!1:(a.enableOnTouchDevices||o.deviceType===x.DESKTOP)&&window.innerWidth>=a.minWidth}const M=n.computed(()=>o.isEnabled?{transform:`translate3d(0, ${-o.currentScrollPosition}px, 0)`}:{});return(f,s)=>(n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass([a.defaultClassNames.smoothPage,a.additionalClassNames.smoothPage])},[n.createElementVNode("div",{ref_key:"contentRef",ref:I,style:n.normalizeStyle(n.unref(M)),class:n.normalizeClass([a.defaultClassNames.smoothPageBody,a.additionalClassNames.smoothPageBody])},[n.renderSlot(f.$slots,"default")],6)],2))}});const se=H.defineStore("publicSmoothPage",()=>{const e=q(),t=n.computed(()=>e.settings),o=n.computed(()=>e.currentScrollPosition),l=n.computed(()=>e.isEnabled),h=n.computed(()=>e.isTriggeringScrollPosition),a=n.computed(()=>e.isMounted),u=n.computed(()=>e.isInited),I=n.computed(()=>e.deviceType),m=n.computed(()=>e.browser),b=n.computed(()=>e.isPreventScroll);return{settings:t,currentScrollPosition:o,isEnabled:l,isTriggeringScrollPosition:h,isMounted:a,isInited:u,deviceType:I,browser:m,isPreventScroll:b,preventScroll:s=>e.preventScroll(s),reload:(s=!1)=>e.reload(s),destroy:(s=!1)=>e.destroy(s),init:(s=!1)=>e.init(s)}}),ce={install(e,t){e.component("SmoothPage",G),e.provide("smoothPageSettings",t||{})}};exports.SmoothPage=G;exports.default=ce;exports.useSmoothPage=se;
